USE WAREHOUSE BENCHMARK_1XL;
USE DATABASE BENCHMARK;

CREATE SCHEMA IF NOT EXISTS TPCDS_SF10TCL;
GRANT ALL ON SCHEMA TPCDS_SF10TCL TO PUBLIC;

CREATE SCHEMA IF NOT EXISTS TPCDS_SF10TCL_AGGREGATES;
GRANT ALL ON SCHEMA TPCDS_SF10TCL_AGGREGATES TO PUBLIC;

--select 'CREATE OR REPLACE VIEW TPCDS_SF10TCL.' || table_name || ' AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.' || table_name || ';'
--from SNOWFLAKE_SAMPLE_DATA.information_schema.tables where table_schema = 'TPCDS_SF10TCL';

CREATE OR REPLACE VIEW TPCDS_SF10TCL.CALL_CENTER AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CALL_CENTER;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CATALOG_PAGE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_PAGE;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CATALOG_RETURNS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_RETURNS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CATALOG_SALES AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CUSTOMER AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CUSTOMER_ADDRESS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.DATE_DIM AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.DBGEN_VERSION AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DBGEN_VERSION;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.INCOME_BAND AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INCOME_BAND;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.INVENTORY AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.ITEM AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.PROMOTION AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.PROMOTION;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.REASON AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.REASON;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.SHIP_MODE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.SHIP_MODE;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.STORE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.STORE_RETURNS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_RETURNS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.STORE_SALES AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.TIME_DIM AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.TIME_DIM;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.WAREHOUSE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.WEB_PAGE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.WEB_RETURNS AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.WEB_SALES AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES;
CREATE OR REPLACE VIEW TPCDS_SF10TCL.WEB_SITE AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SITE;

--select 'GRANT ALL ON TPCDS_SF10TCL.' || table_name || ' TO PUBLIC;'
--from SNOWFLAKE_SAMPLE_DATA.information_schema.tables where table_schema = 'TPCDS_SF10TCL';

GRANT ALL ON TPCDS_SF10TCL.CALL_CENTER TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CATALOG_PAGE TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CATALOG_RETURNS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CATALOG_SALES TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CUSTOMER TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CUSTOMER_ADDRESS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.DATE_DIM TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.DBGEN_VERSION TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.HOUSEHOLD_DEMOGRAPHICS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.INCOME_BAND TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.INVENTORY TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.ITEM TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.PROMOTION TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.REASON TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.SHIP_MODE TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.STORE TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.STORE_RETURNS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.STORE_SALES TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.TIME_DIM TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.WAREHOUSE TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.WEB_PAGE TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.WEB_RETURNS TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.WEB_SALES TO PUBLIC;
GRANT ALL ON TPCDS_SF10TCL.WEB_SITE TO PUBLIC;

-- These are Snowflake's Cluster Keys
--
-- LINEAR(CC_CALL_CENTER_SK)
-- LINEAR(CP_CATALOG_PAGE_SK)
-- LINEAR(CR_RETURNED_DATE_SK, CR_ITEM_SK)
-- LINEAR(CS_SOLD_DATE_SK, CS_ITEM_SK)
-- LINEAR(C_CUSTOMER_SK)
-- LINEAR(CA_ADDRESS_SK)
-- LINEAR(CD_DEMO_SK)
-- LINEAR(D_DATE_SK)
-- LINEAR(HD_DEMO_SK)
-- LINEAR(IB_INCOME_BAND_SK)
-- LINEAR(INV_DATE_SK, INV_ITEM_SK)
-- LINEAR(I_ITEM_SK)
-- LINEAR(P_PROMO_SK)
-- LINEAR(R_REASON_SK)
-- LINEAR(SM_SHIP_MODE_SK)
-- LINEAR(S_STORE_SK)
-- LINEAR(SR_RETURNED_DATE_SK, SR_ITEM_SK)
-- LINEAR(SS_SOLD_DATE_SK, SS_ITEM_SK)
-- LINEAR(T_TIME_SK)
-- LINEAR(W_WAREHOUSE_SK)
-- LINEAR(WP_WEB_PAGE_SK)
-- LINEAR(WR_RETURNED_DATE_SK, WR_ITEM_SK)
-- LINEAR(WS_SOLD_DATE_SK, WS_ITEM_SK)
-- LINEAR(WEB_SITE_SK)
